<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>EarthAccess Demo</title>
  </head>
  <body>
    <h1>EarthAccess demo</h1>
    <form id="searchForm">
      <label>short_name: <input name="short_name" value="ATL06"/></label><br/>
      <label>bbox (minLon,minLat,maxLon,maxLat): <input name="bbox" value="-10,20,10,50"/></label><br/>
      <label>temporal (start,end): <input name="temporal" value="1999-02,2019-03"/></label><br/>
      <label>count: <input name="count" value="5"/></label><br/>
      <button type="button" onclick="doSearch()">Search</button>
      <button type="button" onclick="doDownload()">Download</button>
    </form>

    <pre id="out"></pre>

    <script>
      async function doSearch(){
        const f = document.getElementById('searchForm')
        const short_name = f.short_name.value
        const bbox = f.bbox.value.split(',').map(Number)
        const temporal = f.temporal.value.split(',')
        const count = Number(f.count.value)

        const resp = await fetch('/search', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({short_name, bounding_box: bbox, temporal, count})
        })
        const j = await resp.json()
        document.getElementById('out').textContent = JSON.stringify(j, null, 2)
      }

      async function doDownload(){
        const f = document.getElementById('searchForm')
        const short_name = f.short_name.value
        const bbox = f.bbox.value.split(',').map(Number)
        const temporal = f.temporal.value.split(',')
        const count = Number(f.count.value)

        const resp = await fetch('/download', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({short_name, bounding_box: bbox, temporal, count})
        })
        const j = await resp.json()
        document.getElementById('out').textContent = JSON.stringify(j, null, 2)
      }
    </script>
  </body>
</html>
